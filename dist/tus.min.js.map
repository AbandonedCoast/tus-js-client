{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","lib/browser/base64.js","lib/browser/request.js","lib/browser/storage.js","lib/fingerprint.js","lib/index.js","lib/upload.js","node_modules/extend/index.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","tus","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"_dereq_","encode","btoa","_window","data","unescape","encodeURIComponent","isSupported","newRequest","XMLHttpRequest","setItem","getItem","removeItem","hasStorage","localStorage","SECURITY_ERR","canStoreURLs","key","value","fingerprint","file","name","type","size","lastModified","join","defaultOptions","_upload2","default","Blob","prototype","slice","Upload","_storage","Base64","_interopRequireWildcard","_base","Storage","endpoint","_fingerprint2","resume","onProgress","onChunkComplete","onSuccess","onError","headers","chunkSize","Infinity","withCredentials","uploadUrl","options","_extend2","url","_xhr","_fingerprint","_offset","_aborted","_size","_emitError","_resumeUpload","resumedUrl","_createUpload","abort","xhr","err","originalRequest","bytesSent","bytesTotal","bytesAccepted","setRequestHeader","_request","open","onload","status","_this","_emitXhrError","getResponseHeader","_startUpload","onerror","_setupXHR","metadata","encodeMetadata","send","_this2","offset","parseInt","isNaN","_emitProgress","_emitSuccess","_this3","_emitChunkComplete","upload","onprogress","lengthComputable","start","loaded","end","encoded","push","hasOwn","Object","hasOwnProperty","toStr","toString","isArray","arr","Array","isPlainObject","obj","hasOwnConstructor","hasIsPrototypeOf","constructor","extend","src","copy","copyIsArray","clone","target","arguments","deep"],"mappings":"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","file":"generated.js","sourceRoot":"","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/* global: window */\n\nconst {btoa} = window;\n\nexport function encode(data) {\n  return btoa(unescape(encodeURIComponent(data)));\n}\n\nexport const isSupported = \"btoa\" in window;\n","/* global window */\n\nexport function newRequest() {\n  return new window.XMLHttpRequest();\n}\n","/* global window, localStorage */\n\nlet hasStorage = false;\ntry {\n  hasStorage = \"localStorage\" in window;\n  // Attempt to access localStorage\n  localStorage.length;\n} catch(e) {\n  // If we try to access localStorage inside a sandboxed iframe, a SecurityError\n  // is thrown whenever we are trying to access the localStorage object.\n  if(e.code === e.SECURITY_ERR) {\n    hasStorage = false;\n  } else {\n    throw e;\n  }\n}\n\nexport const canStoreURLs = hasStorage;\n\nexport function setItem(key, value) {\n  if(!hasStorage) return;\n  return localStorage.setItem(key, value);\n}\n\nexport function getItem(key) {\n  if(!hasStorage) return;\n  return localStorage.getItem(key);\n}\n\nexport function removeItem(key) {\n  if(!hasStorage) return;\n  return localStorage.removeItem(key);\n}\n","/**\n * Generate a fingerprint for a file which will be used the store the endpoint\n *\n * @param {File} file\n * @return {String}\n */\nexport default function fingerprint(file) {\n  return [\n\t\t\"tus\",\n\t\tfile.name,\n\t\tfile.type,\n\t\tfile.size,\n\t\tfile.lastModified\n  ].join(\"-\");\n}\n","/* global window */\nimport Upload from \"./upload\";\nimport {canStoreURLs} from \"./node/storage\";\n\nconst {defaultOptions} = Upload;\n\nif (typeof window !== \"undefined\") {\n  // Browser environment using XMLHttpRequest\n  const {XMLHttpRequest, Blob} = window;\n\n  var isSupported = (\n    XMLHttpRequest &&\n    Blob &&\n    typeof Blob.prototype.slice === \"function\"\n  );\n} else {\n  // Node.js environment using http module\n  var isSupported = true;\n}\n\n// The usage of the commonjs exporting syntax instead of the new ECMAScript\n// one is actually inteded and prevents weird behaviour if we are trying to\n// import this module in another module using Babel.\nmodule.exports = {\n  Upload,\n  isSupported,\n  canStoreURLs,\n  defaultOptions\n};\n","/* global window */\nimport fingerprint from \"./fingerprint\";\nimport extend from \"extend\";\n\n// We import the files used inside the Node environment which are rewritten\n// for browsers using the rules defined in the package.json\nimport {newRequest} from \"./node/request\";\nimport * as Base64 from \"./node/base64\";\nimport * as Storage from \"./node/storage\";\n\nconst defaultOptions = {\n  endpoint: \"\",\n  fingerprint,\n  resume: true,\n  onProgress: null,\n  onChunkComplete: null,\n  onSuccess: null,\n  onError: null,\n  headers: {},\n  chunkSize: Infinity,\n  withCredentials: false,\n  uploadUrl: null\n};\n\nclass Upload {\n  constructor(file, options) {\n    this.options = extend(true, {}, defaultOptions, options);\n\n    // The underlying File/Blob object\n    this.file = file;\n\n    // The URL against which the file will be uploaded\n    this.url = null;\n\n    // The underlying XHR object for the current PATCH request\n    this._xhr = null;\n\n    // The fingerpinrt for the current file (set after start())\n    this._fingerprint = null;\n\n    // The offset used in the current PATCH request\n    this._offset = null;\n\n    // True if the current PATCH request has been aborted\n    this._aborted = false;\n\n    // The file's size in bytes\n    this._size = null;\n  }\n\n  start() {\n    let file = this.file;\n\n    if (!file) {\n      this._emitError(new Error(\"tus: no file or stream to upload provided\"));\n      return;\n    }\n\n    if (!this.options.endpoint) {\n        this._emitError(new Error(\"tus: no endpoint provided\"));\n        return;\n    }\n\n    // Allow File#size (browsers) and Buffer#length (Node) as sizes\n    this._size = file.size || file.length || null;\n    if (this._size == null) {\n      this._emitError(new Error(\"tus: file's size not provided\"));\n      return;\n    }\n\n    // A URL has manually been specified, so we try to resume\n    if (this.options.uploadUrl != null) {\n        this.url = this.options.uploadUrl;\n        this._resumeUpload();\n        return;\n    }\n\n    // Try to find the endpoint for the file in the storage\n    if (this.options.resume) {\n        this._fingerprint = this.options.fingerprint(file);\n        let resumedUrl = Storage.getItem(this._fingerprint);\n\n        if (resumedUrl != null) {\n            this.url = resumedUrl;\n            this._resumeUpload();\n            return;\n        }\n    }\n\n    // An upload has not started for the file yet, so we start a new one\n    this._createUpload();\n  }\n\n  abort() {\n    if (this._xhr !== null) {\n      this._xhr.abort();\n      this._aborted = true;\n    }\n  }\n\n  _emitXhrError(xhr, err) {\n    err.originalRequest = xhr;\n    this._emitError(err);\n  }\n\n  _emitError(err) {\n    if (typeof this.options.onError === \"function\") {\n      this.options.onError(err);\n    } else {\n      throw err;\n    }\n  }\n\n  _emitSuccess() {\n    if (typeof this.options.onSuccess === \"function\") {\n      this.options.onSuccess();\n    }\n  }\n\n  /**\n   * Publishes notification when data has been sent to the server. This\n   * data may not have been accepted by the server yet.\n   * @param  {number} bytesSent  Number of bytes sent to the server.\n   * @param  {number} bytesTotal Total number of bytes to be sent to the server.\n   */\n  _emitProgress(bytesSent, bytesTotal) {\n    if (typeof this.options.onProgress === \"function\") {\n      this.options.onProgress(bytesSent, bytesTotal);\n    }\n  }\n\n  /**\n   * Publishes notification when a chunk of data has been sent to the server\n   * and accepted by the server.\n   * @param  {number} chunkSize  Size of the chunk that was accepted by the\n   *                             server.\n   * @param  {number} bytesAccepted Total number of bytes that have been\n   *                                accepted by the server.\n   * @param  {number} bytesTotal Total number of bytes to be sent to the server.\n   */\n  _emitChunkComplete(chunkSize, bytesAccepted, bytesTotal) {\n    if (typeof this.options.onChunkComplete === \"function\") {\n      this.options.onChunkComplete(chunkSize, bytesAccepted, bytesTotal);\n    }\n  }\n\n  /**\n   * Set the headers used in the request and the withCredentials property\n   * as defined in the options\n   *\n   * @param {XMLHttpRequest} xhr\n   */\n  _setupXHR(xhr) {\n    xhr.setRequestHeader(\"Tus-Resumable\", \"1.0.0\");\n    let headers = this.options.headers;\n\n    for (let name in headers) {\n      xhr.setRequestHeader(name, headers[name]);\n    }\n\n    xhr.withCredentials = this.options.withCredentials;\n  }\n\n  /**\n   * Create a new upload using the creation extension by sending a POST\n   * request to the endpoint. After successful creation the file will be\n   * uploaded\n   *\n   * @api private\n   */\n  _createUpload() {\n    let xhr = newRequest();\n    xhr.open(\"POST\", this.options.endpoint, true);\n\n    xhr.onload = () => {\n      if (!(xhr.status >= 200 && xhr.status < 300)) {\n        this._emitXhrError(xhr, new Error(\"tus: unexpected response while creating upload\"));\n        return;\n      }\n\n      this.url = xhr.getResponseHeader(\"Location\");\n\n      if (this.options.resume) {\n        Storage.setItem(this._fingerprint, this.url);\n      }\n\n      this._offset = 0;\n      this._startUpload();\n    };\n\n    xhr.onerror = () => {\n      this._emitXhrError(xhr, new Error(\"tus: failed to create upload\"));\n    };\n\n    this._setupXHR(xhr);\n    xhr.setRequestHeader(\"Upload-Length\", this._size);\n\n    // Add metadata if values have been added\n    var metadata = encodeMetadata(this.options.metadata);\n    if (metadata !== \"\") {\n        xhr.setRequestHeader(\"Upload-Metadata\", metadata);\n    }\n\n    xhr.send(null);\n  }\n\n  /*\n   * Try to resume an existing upload. First a HEAD request will be sent\n   * to retrieve the offset. If the request fails a new upload will be\n   * created. In the case of a successful response the file will be uploaded.\n   *\n   * @api private\n   */\n  _resumeUpload() {\n    let xhr = newRequest();\n    xhr.open(\"HEAD\", this.url, true);\n\n    xhr.onload = () => {\n      if (!(xhr.status >= 200 && xhr.status < 300)) {\n        if (this.options.resume) {\n          // Remove stored fingerprint and corresponding endpoint,\n          // since the file can not be found\n          Storage.removeItem(this._fingerprint);\n        }\n\n        // Try to create a new upload\n        this.url = null;\n        this._createUpload();\n        return;\n      }\n\n      let offset = parseInt(xhr.getResponseHeader(\"Upload-Offset\"), 10);\n      if (isNaN(offset)) {\n        this._emitXhrError(xhr, new Error(\"tus: invalid or missing offset value\"));\n        return;\n      }\n\n      let length = parseInt(xhr.getResponseHeader(\"Upload-Length\"), 10);\n      if (isNaN(length)) {\n        this._emitXhrError(xhr, new Error(\"tus: invalid or missing length value\"));\n        return;\n      }\n\n      // Upload has already been completed and we do not need to send additional\n      // data to the server\n      if (offset === length) {\n        this._emitProgress(length, length);\n        this._emitSuccess();\n        return;\n      }\n\n      this._offset = offset;\n      this._startUpload();\n    };\n\n    xhr.onerror = () => {\n      this._emitXhrError(xhr, new Error(\"tus: failed to resume upload\"));\n    };\n\n    this._setupXHR(xhr);\n    xhr.send(null);\n  }\n\n  /**\n   * Start uploading the file using PATCH requests. The file will be divided\n   * into chunks as specified in the chunkSize option. During the upload\n   * the onProgress event handler may be invoked multiple times.\n   *\n   * @api private\n   */\n  _startUpload() {\n    let xhr = this._xhr = newRequest();\n    xhr.open(\"PATCH\", this.url, true);\n\n    xhr.onload = () => {\n      if (!(xhr.status >= 200 && xhr.status < 300)) {\n        this._emitXhrError(xhr, new Error(\"tus: unexpected response while creating upload\"));\n        return;\n      }\n\n      let offset = parseInt(xhr.getResponseHeader(\"Upload-Offset\"), 10);\n      if (isNaN(offset)) {\n        this._emitXhrError(xhr, new Error(\"tus: invalid or missing offset value\"));\n        return;\n      }\n\n      this._emitChunkComplete(offset - this._offset, offset, this._size);\n\n      this._offset = offset;\n\n      if (offset == this._size) {\n        // Yay, finally done :)\n        // Emit a last progress event\n        this._emitProgress(offset, offset);\n        this._emitSuccess();\n        return;\n      }\n\n      this._startUpload();\n    };\n\n    xhr.onerror = () => {\n      // Don't emit an error if the upload was aborted manually\n      if (this._aborted) {\n        return;\n      }\n\n      this._emitXhrError(xhr, new Error(\"tus: failed to upload chunk at offset \" + this._offset));\n    };\n\n    // Test support for progress events before attaching an event listener\n    if (\"upload\" in xhr) {\n      xhr.upload.onprogress = (e) => {\n        if (!e.lengthComputable) {\n          return;\n        }\n\n        this._emitProgress(start + e.loaded, this._size);\n      };\n    }\n\n    this._setupXHR(xhr);\n\n    xhr.setRequestHeader(\"Upload-Offset\", this._offset);\n    xhr.setRequestHeader(\"Content-Type\", \"application/offset+octet-stream\");\n\n    let start = this._offset;\n    let end = this._offset + this.options.chunkSize;\n\n    if (end === Infinity) {\n      end = this._size;\n    }\n\n    xhr.send(this.file.slice(start, end));\n  }\n}\n\nfunction encodeMetadata(metadata) {\n    if (!Base64.isSupported) {\n        return \"\";\n    }\n\n    var encoded = [];\n\n    for (var key in metadata) {\n        encoded.push(key + \" \" + Base64.encode(metadata[key]));\n    }\n\n    return encoded.join(\",\");\n}\n\nUpload.defaultOptions = defaultOptions;\n\nexport default Upload;\n","'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) {/**/}\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone,\n\t\ttarget = arguments[0],\n\t\ti = 1,\n\t\tlength = arguments.length,\n\t\tdeep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t} else if ((typeof target !== 'object' && typeof target !== 'function') || target == null) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = target[name];\n\t\t\t\tcopy = options[name];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\ttarget[name] = extend(deep, clone, copy);\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\n"]}